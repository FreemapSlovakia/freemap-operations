<html>
	<link href="https://www.tabulator.info/css/tabulator/5.2/tabulator.css" rel="stylesheet">
	<link href="dist/css/tabulator.min.css" rel="stylesheet">
	<title>MINV adresy vs OSM</title>
			<script type="text/javascript" src="dist/js/tabulator.min.js"></script>
			<style>
#title {
  height: fit-content;
  padding: 0;
}
 #main-table {
   height: 80%;
 }
			</style>
			<head>
			</head>
			<body>
				<div id="title">
					<h2>MINV d√°ta (adresy) vs OSM</h2>
					<p>Kliknut√≠m na n√°zov obce sa otvor√≠ okno s v√Ωsledkom spracovania. Po kliknut√≠ na stƒ∫pec pod logom JOSM sa v√Ωsledn√Ω s√∫bor otvor√≠ v tomto editore (je nutn√© povoli≈• Remote control v nastaveniach JOSM).</p>
					<p>T√°to tabuƒæka bola vygenerovan√° d≈àa {{ today }}. Spracovanie v≈°etk√Ωch obc√≠ spravidla be≈æ√≠ v t√Ω≈ædennom intervale a trv√° pribli≈æne 15 hod√≠n.</p>
					<p>Zdrojov√Ω k√≥d n√°jdete na <a href="https://github.com/FreemapSlovakia/freemap-operations/tree/master/mass_edits/import_adries_minv">https://github.com/FreemapSlovakia/freemap-operations</a></p>
				</div>
				<div id="main-table">
				T√°to str√°nka vy≈æaduje zapnut√Ω Javascript. Ako alternat√≠vu m√¥≈æete pou≈æi≈• <a href="index2.html">tento zoznam</a> odkazov na jednotliv√© obce/mest√°.
				</div>
				<script>
		     function nameFilter(headerValue, rowValue, rowData, filterParams) {
            const combining = /[\u0300-\u036F]/g
            var obec_normalized = rowValue.normalize('NFKD').replace(combining, '').toLowerCase()
            var rowfilter_normalized = headerValue.normalize('NFKD').replace(combining, '').toLowerCase().trim()
            return obec_normalized.indexOf(rowfilter_normalized) != -1
          }

					var table = new Tabulator("#main-table", {
											ajaxURL: window.location + "obce.json",
											layout: "fitData",
											responsiveLayout: "hide",
											tooltips: true,
											addRowPos: "top",
											pagination: "local",
											langs: {
																	"sk-sk": {
																							"pagination": {
																													"first": "Prv√°",
																													"first_title": "Prv√° strana",
																													"last": "Posledn√°",
																													"last_title": "Posledn√° strana",
																													"prev": "Predch√°dzaj√∫ca",
																													"prev_title": "Predch strana",
																													"next": "ƒéal≈°ia",
																													"next_title": "ƒéal≈°ia strana",
																													"all": "V≈°etky",
																													"page_title": "Zobrazi≈• stranu",
																													"counter": {
																																			"showing": "Zobrazuje sa",
																																			"of": "z",
																																			"rows": "riadkov",
																																			"pages": "str√°n",
																																		}
																												},
																						}
																},
											paginationCounter:"rows",
											columns: [
																	{title: "K√≥d obce", field: "KodObce", headerFilter: "input"},
												          {title: "Obec/Mesto", field: "Obec", headerFilter: "input", headerFilterFunc: nameFilter},
                                  {title: "Okres", field: "Okres", headerFilter: "input", headerFilterFunc: nameFilter},
                                  {title: "Kraj", field: "Kraj", headerFilter: "input", headerFilterFunc: nameFilter},
																	{title: "Generovan√©", field: "Generovan√©"},
												          {title: "‚Æº",
													         field: "Budovy",
																	 formatter: "color",
																	 headerTooltip: "Prekr√Ωvaj√∫ce sa<br>budovy"},
												          {title: "<img src='https://upload.wikimedia.org/wikipedia/commons/thumb/c/c0/JOSM_Logotype_2019.svg/180px-JOSM_Logotype_2019.svg.png' width=30px>",
																	 field: "V√Ωsledok",
																	 headerTooltip: "Otvori≈• v JOSM",
													         headerSort: false},
																	{title: "OSM",
																	field: "OSM",
																	topCalc: "sum"},
																	{title: "MINV",
																	field: "MINV",
																	topCalc: "sum"},
																	{title: "%",
																	field: "ratio",
																	},
																],
											initialSort:[
																	{column:"Obec", dir:"asc"},
																],
										});
					table.on("cellClick", function(e, cell){
											clicked_text = cell._cell.value;
											city = cell._cell.element.parentElement.firstElementChild.textContent.split(" (")[0];
											console.log(clicked_text);
											if ( clicked_text != "ü°ï" )
											{
																	window.open(city);
																}
											else {
																	window.open('http://localhost:8111/import?url=' + window.location + city + '/result_' + city + '.osm',
																							'_blank');
																	window.open().close();
																};
										});
					table.on("tableBuilt", function() {
											table.setLocale("sk-sk");
										});
				</script>
			</body>
</html>
